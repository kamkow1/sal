
declare proc printf(format *int8, ...) int

declare var b int

template(T) define proc generic_proc(x *$T) $T
{
    define var cond int = 10

    if cond seq 1 {
        return 33
    } elif cond seq 2 {
        return 22
    } elif cond seq 3 {
        return 44
    }

    return *x
}

define proc regular_proc() int
{
    return 1
}

call make_template(generic_proc, type int)

define proc Main() void
{
    define var a int = 4

    a = 6

    // b = 10 // Will segfault, because b is not linked yet

    declare var c *int

    c = &a

    declare var d *proc() void

    d = &Main

    define var p *int8 = call cast(type *int8, &"Hello world\n")
    call printf(p)

    call printf(call cast(type *int8, &"Hello from SAL, %d\n"), *c)

    *c = 6969

    call printf(call cast(type *int8, &"generic_proc: %d\n"), call(type int) generic_proc(c))
    
}

